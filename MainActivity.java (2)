package com.example.wifimonitor;

import android.content.Context;
import android.net.wifi.WifiInfo;
import android.net.wifi.WifiManager;
import android.os.Bundle;
import android.os.Handler;
import android.widget.LinearLayout;
import android.widget.TextView;
import android.graphics.Color;
import android.view.Gravity;
import androidx.appcompat.app.AppCompatActivity;

public class MainActivity extends AppCompatActivity {
    private TextView ssidText, ipText, signalText;
    private Handler handler = new Handler();
    private Runnable runnable;

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);

        // Ø¥Ø¹Ø¯Ø§Ø¯ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø¨Ø±Ù…Ø¬ÙŠØ§Ù‹ (Layout)
        LinearLayout layout = new LinearLayout(this);
        layout.setOrientation(LinearLayout.VERTICAL);
        layout.setPadding(60, 100, 60, 60);
        layout.setBackgroundColor(Color.parseColor("#F5F5F5"));
        layout.setGravity(Gravity.TOP);

        // Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
        TextView title = new TextView(this);
        title.setText("ğŸ“¡ WiFi Monitor Pro");
        title.setTextSize(28);
        title.setTextColor(Color.parseColor("#2196F3"));
        title.setGravity(Gravity.CENTER);
        title.setPadding(0, 0, 0, 80);
        layout.addView(title);

        // Ø¥Ù†Ø´Ø§Ø¡ Ù†ØµÙˆØµ Ø§Ù„Ø¹Ø±Ø¶
        ssidText = createInfoTextView();
        ipText = createInfoTextView();
        signalText = createInfoTextView();

        layout.addView(ssidText);
        layout.addView(ipText);
        layout.addView(signalText);

        setContentView(layout);

        // Ø¨Ø¯Ø¡ Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ ÙƒÙ„ Ø«Ø§Ù†ÙŠØ©
        startMonitoring();
    }

    private TextView createInfoTextView() {
        TextView tv = new TextView(this);
        tv.setTextSize(18);
        tv.setTextColor(Color.DKGRAY);
        tv.setPadding(20, 20, 20, 20);
        tv.setBackgroundColor(Color.WHITE);
        LinearLayout.LayoutParams params = new LinearLayout.LayoutParams(
            LinearLayout.LayoutParams.MATCH_PARENT, 
            LinearLayout.LayoutParams.WRAP_CONTENT
        );
        params.setMargins(0, 10, 0, 10);
        tv.setLayoutParams(params);
        return tv;
    }

    private void startMonitoring() {
        runnable = new Runnable() {
            @Override
            public void run() {
                updateWifiInfo();
                handler.postDelayed(this, 1000); // ØªØ­Ø¯ÙŠØ« ÙƒÙ„ 1000 Ù…ÙŠÙ„ÙŠ Ø«Ø§Ù†ÙŠØ© (Ø«Ø§Ù†ÙŠØ© ÙˆØ§Ø­Ø¯Ø©)
            }
        };
        handler.post(runnable);
    }

    private void updateWifiInfo() {
        WifiManager wifiManager = (WifiManager) getApplicationContext().getSystemService(Context.WIFI_SERVICE);
        WifiInfo info = wifiManager.getConnectionInfo();

        String ssid = info.getSSID();
        int ip = info.getIpAddress();
        String ipString = String.format("%d.%d.%d.%d", (ip & 0xff), (ip >> 8 & 0xff), (ip >> 16 & 0xff), (ip >> 24 & 0xff));
        int rssi = info.getRssi();

        ssidText.setText("Network: " + ssid.replace("\"", ""));
        ipText.setText("IP Address: " + ipString);
        signalText.setText("Signal Strength: " + rssi + " dBm");

        // ØªØºÙŠÙŠØ± Ù„ÙˆÙ† Ø¥Ø´Ø§Ø±Ø© Ø§Ù„Ù‚ÙˆØ© Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø¬ÙˆØ¯Ø©
        if (rssi > -50) signalText.setTextColor(Color.GREEN);
        else if (rssi > -70) signalText.setTextColor(Color.parseColor("#FFA500"));
        else signalText.setTextColor(Color.RED);
    }

    @Override
    protected void onDestroy() {
        super.onDestroy();
        handler.removeCallbacks(runnable); // Ø¥ÙŠÙ‚Ø§Ù Ø§Ù„ØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø¯ Ø¥ØºÙ„Ø§Ù‚ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚
    }
}

